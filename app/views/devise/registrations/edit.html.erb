<%= render 'partials/header' %>
<div class="changologs-app-container">
  <%= render 'partials/sidebar' %>
  <div class="app-content">
    <div class="container">
      <div class="row">
        <div class="col-md-12 rounded">
          <h1 class="border-bottom pb-2"><%= t('.title', resource: resource_name.to_s.humanize) %></h1>

          <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, multipart: true }) do |f| %>
            <%= bootstrap_devise_error_messages! %>
            <div class="text-center mb-4 mt-3">
            <% if current_user.profile_picture.attached? %>
              <%= image_tag rails_blob_url(current_user.profile_picture), class: 'big-profile-picture' %>
            <% end %>
            </div>
            <div class="form-group">
              <%= f.label :profile_picture %>
              <%= f.file_field :profile_picture, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :email %>
              <%= f.email_field :email, autofocus: true, autocomplete: 'email', disabled: true, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :first_name %>
              <%= f.text_field :first_name, autofocus: true, autocomplete: 'first_name', class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :last_name %>
              <%= f.text_field :last_name, autofocus: true, autocomplete: 'last_name', class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :password %>
              <%= f.password_field :password, autocomplete: 'new-password', class: 'form-control' %>

              <small class="form-text text-muted"><%= t('.leave_blank_if_you_don_t_want_to_change_it') %></small>
            </div>

            <div class="form-group">
              <%= f.label :password_confirmation %>
              <%= f.password_field :password_confirmation, autocomplete: 'new-password', class: 'form-control'  %>
            </div>

            <div class="form-group">
              <%= f.label :current_password %>
              <%= f.password_field :current_password, autocomplete: 'current-password', class: 'form-control' %>

              <small class="form-text text-muted"><%= t('.we_need_your_current_password_to_confirm_your_changes') %></small>
            </div>

            <% if resource.otp_required_for_login %>
              <div class="field mb-3">
                <i>Enter OTP to disable 2FA</i>
                <%= f.text_field :otp_attempt %>
              </div>
            <% else %>
              <div class="form mb-3">
                <i>Enable 2FA?</i>            
                <%= link_to "Enable 2FA", enable_otp_show_qr_path %>
              </div>
            <% end %>

            <div class="form-group">
              <%= f.submit t('.update'), class: 'btn btn-primary' %>
              <%= link_to t('.back'), profile_path %>
            </div>
          <% end %>

          
        </div>
      </div>
    </div>
  </div>
</div>